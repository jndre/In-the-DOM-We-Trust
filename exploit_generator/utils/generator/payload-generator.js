(function (global) {
  "use strict";

  function getPayload(uuid) {
    console.log("-> Generating payload");
    return getXssPayload(uuid);
  }

  function getXssPayload(uuid) {
    return `taintfoxLog('${uuid.replace(/-/g, "")}')`;
  }

  function getXssPayloadForNotifier(finding, taint) {
    return (
      "taintfoxLog(" +
      finding.meta.id +
      "," +
      finding.taint.indexOf(taint) +
      "," +
      finding.meta.tabId +
      ")"
    );
  }

  function getMongoPayload(finding, taint) {
    return null;
  }

  global.getPayload = getPayload;
})(exports);
