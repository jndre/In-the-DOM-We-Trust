(function(global) {
	'use strict';

	function decodeCompletley(snippet) {
		var oldSnippet;
		try {
			do {
				oldSnippet = snippet;
				snippet = decodeURI(oldSnippet);
			} while (snippet.length != oldSnippet.length);

			do {
				oldSnippet = snippet;
				snippet = decodeURIComponent(oldSnippet);
			} while (snippet.length != oldSnippet.length);
		} catch(err) {
			console.log("URL decoding error!");
		}

		return snippet;
	}

	function encodeForTaint(taintPart, snippet) {
		for(var operation of taintPart.operators) {
			if (operation.op === "unescape") snippet = encodeURI(snippet);
			if (operation.op === "decodeURI") snippet = encodeURI(snippet);
			if (operation.op === "decodeURIComponent") snippet = encodeURIComponent(snippet);
			if (operation.op === "escape") snippet = decodeURI(snippet);
			if (operation.op === "encodeURI") snippet = decodeURI(snippet);
			if (operation.op === "encodeURIComponent") snippet = decodeURIComponent(snippet);
		}
		return snippet;
	}

	global.decodeCompletley = decodeCompletley;
	global.encodeForTaint = encodeForTaint;

})(exports);